<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (25) on Tue Nov 11 10:26:03 UTC 2025 -->
<title>SecurityUtils (Javadoc)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-11-11">
<meta name="description" content="declaration: package: eu.righettod, class: SecurityUtils">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../resource-files/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="../../resource-files/stylesheet.css">
<script type="text/javascript" src="../../script-files/script.js"></script>
<script type="text/javascript" src="../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/SecurityUtils.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../search.html">Search</a></li>
<li><a href="../../help-doc.html#class">Help</a></li>
</ul>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">eu.righettod</a></li>
<li><a href="SecurityUtils.html" class="current-selection">SecurityUtils</a></li>
</ol>
<div class="nav-list-search"><input type="text" id="search-input" disabled placeholder="Search documentation (type /)" aria-label="Search in documentation" autocomplete="off" spellcheck="false"><input type="reset" id="reset-search" disabled value="Reset"></div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;<input type="text" class="filter-input" disabled placeholder="Filter contents (type .)" aria-label="Filter table of contents" autocomplete="off" spellcheck="false"><input type="reset" class="reset-filter" disabled tabindex="-1" value="Reset"></div>
<ol class="toc-list" tabindex="-1">
<li><a href="#" tabindex="0">Description</a></li>
<li><a href="#method-summary" tabindex="0">Method Summary</a></li>
<li><a href="#method-detail" tabindex="0">Method Details</a>
<ol class="toc-list">
<li><a href="#isWeakPINCode(java.lang.String)" tabindex="0">isWeakPINCode(String)</a></li>
<li><a href="#isWord972003DocumentSafe(java.lang.String)" tabindex="0">isWord972003DocumentSafe(String)</a></li>
<li><a href="#isXMLSafe(java.lang.String)" tabindex="0">isXMLSafe(String)</a></li>
<li><a href="#extractAllPDFLinks(java.lang.String)" tabindex="0">extractAllPDFLinks(String)</a></li>
<li><a href="#isPDFSafe(java.lang.String)" tabindex="0">isPDFSafe(String)</a></li>
<li><a href="#clearPDFMetadata(org.apache.pdfbox.pdmodel.PDDocument)" tabindex="0">clearPDFMetadata(PDDocument)</a></li>
<li><a href="#isRelativeURL(java.lang.String)" tabindex="0">isRelativeURL(String)</a></li>
<li><a href="#isZIPSafe(java.lang.String,int,boolean)" tabindex="0">isZIPSafe(String, int, boolean)</a></li>
<li><a href="#identifyMimeType(byte%5B%5D)" tabindex="0">identifyMimeType(byte[])</a></li>
<li><a href="#isPublicIPAddress(java.lang.String)" tabindex="0">isPublicIPAddress(String)</a></li>
<li><a href="#computeHashNoProneToAbuseOnParts(java.util.List)" tabindex="0">computeHashNoProneToAbuseOnParts(List)</a></li>
<li><a href="#isXMLOnlyUseAllowedXSDorDTD(java.lang.String,java.util.List)" tabindex="0">isXMLOnlyUseAllowedXSDorDTD(String, List)</a></li>
<li><a href="#isExcelCSVSafe(java.lang.String)" tabindex="0">isExcelCSVSafe(String)</a></li>
<li><a href="#ensureSerializedObjectIntegrity(eu.righettod.ProcessingModeType,java.lang.String,byte%5B%5D)" tabindex="0">ensureSerializedObjectIntegrity(ProcessingModeType, String, byte[])</a></li>
<li><a href="#isJSONSafe(java.lang.String,int,int)" tabindex="0">isJSONSafe(String, int, int)</a></li>
<li><a href="#isImageSafe(java.lang.String,java.util.List)" tabindex="0">isImageSafe(String, List)</a></li>
<li><a href="#sanitizeFile(java.lang.String,eu.righettod.InputFileType)" tabindex="0">sanitizeFile(String, InputFileType)</a></li>
<li><a href="#isEmailAddress(java.lang.String)" tabindex="0">isEmailAddress(String)</a></li>
<li><a href="#isPSD2StetSafeCertificateURL(java.lang.String)" tabindex="0">isPSD2StetSafeCertificateURL(String)</a></li>
<li><a href="#applyURLDecoding(java.lang.String,int)" tabindex="0">applyURLDecoding(String, int)</a></li>
<li><a href="#isPathSafe(java.lang.String)" tabindex="0">isPathSafe(String)</a></li>
<li><a href="#isXMLHaveCommentsOrXSLProcessingInstructions(java.lang.String)" tabindex="0">isXMLHaveCommentsOrXSLProcessingInstructions(String)</a></li>
<li><a href="#applyJWTExtraValidation(com.auth0.jwt.interfaces.DecodedJWT,eu.righettod.TokenType,java.util.List)" tabindex="0">applyJWTExtraValidation(DecodedJWT, TokenType, List)</a></li>
<li><a href="#isRegexSafe(java.lang.String,java.lang.String,java.util.Optional)" tabindex="0">isRegexSafe(String, String, Optional)</a></li>
<li><a href="#computeUUIDv7()" tabindex="0">computeUUIDv7()</a></li>
<li><a href="#isXSDSafe(java.lang.String)" tabindex="0">isXSDSafe(String)</a></li>
<li><a href="#extractAllSensitiveInformation(java.lang.String)" tabindex="0">extractAllSensitiveInformation(String)</a></li>
<li><a href="#isGZIPCompressedDataSafe(byte%5B%5D,long)" tabindex="0">isGZIPCompressedDataSafe(byte[], long)</a></li>
</ol>
</li>
</ol>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span><img src="../../resource-files/left.svg" alt="Hide sidebar"></button><button class="show-sidebar"><img src="../../resource-files/right.svg" alt="Show sidebar"><span>&nbsp;Show sidebar</span></button></nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Class SecurityUtils" class="title">Class SecurityUtils</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">eu.righettod.SecurityUtils</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-93">SecurityUtils</a></span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Provides different utilities methods to apply processing from a security perspective.<br>
These code snippet:
<ul>
    <li>Can be used, as "foundation", to customize the validation to the app context.</li>
    <li>Were implemented in a way to facilitate adding or removal of validations depending on usage context.</li>
    <li>Were centralized on one class to be able to enhance them across time as well as <a href="https://github.com/righettod/code-snippets-security-utils/issues">missing case/bug identification</a>.</li>
</ul>
<br>
<a href="https://github.com/righettod/code-snippets-security-utils">GitHub repository</a>.<br><br>
<a href="https://github.com/righettod/code-snippets-security-utils/blob/main/src/main/java/eu/righettod/SecurityUtils.java">Source code of the class</a>.</div>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#applyJWTExtraValidation(com.auth0.jwt.interfaces.DecodedJWT,eu.righettod.TokenType,java.util.List)" class="member-name-link">applyJWTExtraValidation</a><wbr>(com.auth0.jwt.interfaces.DecodedJWT&nbsp;token,
 <a href="TokenType.html" title="enum class in eu.righettod">TokenType</a>&nbsp;expectedTokenType,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;revokedTokenJTIList)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Perform a set of additional validations against a JWT token:

    Do not use the <b>NONE</b> signature algorithm.
    Have a <a href="https://www.iana.org/assignments/jwt/jwt.xhtml">EXP claim</a> defined.
    The token identifier (<a href="https://www.iana.org/assignments/jwt/jwt.xhtml">JTI claim</a>) is NOT part of the list of revoked token.
    Match the expected type of token: ACCESS or ID or REFRESH.
</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#applyURLDecoding(java.lang.String,int)" class="member-name-link">applyURLDecoding</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;encodedData,
 int&nbsp;decodingRoundThreshold)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Perform sequential URL decoding operations against a URL encoded data until the data is not URL encoded anymore or if the specified threshold is reached.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#clearPDFMetadata(org.apache.pdfbox.pdmodel.PDDocument)" class="member-name-link">clearPDFMetadata</a><wbr>(org.apache.pdfbox.pdmodel.PDDocument&nbsp;document)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Remove as much as possible metadata from the provided PDF document object.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#computeHashNoProneToAbuseOnParts(java.util.List)" class="member-name-link">computeHashNoProneToAbuseOnParts</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;parts)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Compute a SHA256 hash from an input composed of a collection of strings.<br><br>
This method take care to build the source string in a way to prevent this source string to be prone to abuse targeting the different parts composing it.<br><br></div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/UUID.html" title="class or interface in java.util" class="external-link">UUID</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#computeUUIDv7()" class="member-name-link">computeUUIDv7</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Compute a UUID version 7 without using any external dependency.<br><br>
<b>Below are my personal point of view and perhaps I'm totally wrong!</b></div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#ensureSerializedObjectIntegrity(eu.righettod.ProcessingModeType,java.lang.String,byte%5B%5D)" class="member-name-link">ensureSerializedObjectIntegrity</a><wbr>(<a href="ProcessingModeType.html" title="enum class in eu.righettod">ProcessingModeType</a>&nbsp;processingModeType,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;input,
 byte[]&nbsp;secret)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Provide a way to add an integrity marker (<a href="https://en.wikipedia.org/wiki/HMAC">HMAC</a>) to a serialized object serialized using the <a href="https://www.baeldung.com/java-serialization">java native system</a> (binary).<br>
The goal is to provide <b>a temporary workaround</b> to try to prevent deserialization attacks and give time to move to a text-based serialization approach.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/net/URL.html" title="class or interface in java.net" class="external-link">URL</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#extractAllPDFLinks(java.lang.String)" class="member-name-link">extractAllPDFLinks</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;pdfFilePath)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Extract all URL links from a PDF file provided.<br>
This can be used to apply validation on a PDF against contained links.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a><wbr>&lt;<a href="SensitiveInformationType.html" title="enum class in eu.righettod">SensitiveInformationType</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#extractAllSensitiveInformation(java.lang.String)" class="member-name-link">extractAllSensitiveInformation</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;content)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Extract all sensitive information from a string provided.<br>
This can be used to identify any sensitive information into a <a href="https://cwe.mitre.org/data/definitions/532.html">message expected to be written in a log</a> and then replace every sensitive values by an obfuscated ones.<br><br>
For the luxembourg national identification number, this method focus on detecting identifiers for a physical entity (people) and not a moral one (company).<br><br>
I delegated the validation of the IBAN to a dedicated library (<a href="https://github.com/arturmkrtchyan/iban4j">iban4j</a>) to not "reinvent the wheel" and then introduce buggy validation myself.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#identifyMimeType(byte%5B%5D)" class="member-name-link">identifyMimeType</a><wbr>(byte[]&nbsp;content)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Identify the mime type of the content specified (array of bytes).<br>
Note that it cannot be fully trusted (see the tweet '1595824709186519041' referenced), so, additional validations are required.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isEmailAddress(java.lang.String)" class="member-name-link">isEmailAddress</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;addr)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a string expected to be an email address:

Is a valid email address, from a parser perspective, following RFCs on email addresses.
Is not using "Encoded-word" format.
Is not using comment format.
Is not using "Punycode" format.
Is not using UUCP style addresses.
Is not using address literals.
Is not using source routes.
Is not using the "percent hack".
<br>
This is based on the research work from <a href="https://portswigger.net/research/gareth-heyes">Gareth Heyes</a> added in references (Portswigger).<br><br>

<b>Note:</b> The notion of valid, here, is to take from a secure usage of the data perspective.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isExcelCSVSafe(java.lang.String)" class="member-name-link">isExcelCSVSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;csvFilePath)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a EXCEL CSV file provided (file was expected to be opened in Microsoft EXCEL):

Real CSV file.
Do not contains any payload related to a CSV injections.

Ensure that, if Apache Commons CSV does not find any record then, the file will be considered as NOT safe (prevent potential bypasses).<br><br>
<b>Note:</b> Record delimiter used is the <code>,</code> (comma) character.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isGZIPCompressedDataSafe(byte%5B%5D,long)" class="member-name-link">isGZIPCompressedDataSafe</a><wbr>(byte[]&nbsp;compressedBytes,
 long&nbsp;maxCountOfDecompressedBytesAllowed)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a bytes array provided representing GZIP compressed data:

Are valid GZIP compressed data.
The number of bytes once decompressed is under the specified limit.

<br><b>Note:</b> The value <code>Integer.MAX_VALUE - 8</code> was chosen because during my tests on Java 25 (JDK 64 bits on Windows 11 Pro), it was possible to decompress such amount of data with the default JVM settings without causing an <a href="https://docs.oracle.com/en/java/javase/25/docs/api//java.base/java/lang/OutOfMemoryError.html">Out Of Memory error</a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isImageSafe(java.lang.String,java.util.List)" class="member-name-link">isImageSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;imageFilePath,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;imageAllowedMimeTypes)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a image file provided:

Real image file.
Its mime type is into the list of allowed mime types.
Its metadata fields do not contains any characters related to a malicious payloads.

<br>
<b>Important note:</b> This implementation is prone to bypass using the "<b>raw insertion</b>" method documented in the <a href="https://www.synacktiv.com/en/publications/persistent-php-payloads-in-pngs-how-to-inject-php-code-in-an-image-and-keep-it-there">blog post</a> from the Synacktiv team.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isJSONSafe(java.lang.String,int,int)" class="member-name-link">isJSONSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;json,
 int&nbsp;maxItemsByArraysCount,
 int&nbsp;maxDeepnessAllowed)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a JSON string provided:

Real JSON structure.
Contain less than a specified number of deepness for nested objects or arrays.
Contain less than a specified number of items in any arrays.

<br>
<b>Note:</b> I decided to use a parsing approach using only string processing to prevent any StackOverFlow or OutOfMemory error that can be abused.<br><br>
I used the following assumption:

     The character <code>{</code> identify the beginning of an object.
     The character <code>}</code> identify the end of an object.
     The character <code>[</code> identify the beginning of an array.
     The character <code>]</code> identify the end of an array.
     The character <code>"</code> identify the delimiter of a string.
     The character sequence <code>\"</code> identify the escaping of an double quote.
</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isPathSafe(java.lang.String)" class="member-name-link">isPathSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;path)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a string expected to be an system file/folder path:

Does not contains path traversal payload.
The canonical path is equals to the absolute path.
<br></div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isPDFSafe(java.lang.String)" class="member-name-link">isPDFSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;pdfFilePath)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a PDF file provided:

Real PDF file.
No attachments.
No Javascript code.
No links using action of type URI/Launch/RemoteGoTo/ImportData.
No XFA forms in order to prevent exposure to XXE/SSRF like CVE-2025-54988.
</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isPSD2StetSafeCertificateURL(java.lang.String)" class="member-name-link">isPSD2StetSafeCertificateURL</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;certificateUrl)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">The <a href="https://www.stet.eu/en/psd2/">PSD2 STET</a> specification require to use <a href="https://datatracker.ietf.org/doc/draft-cavage-http-signatures/">HTTP Signature</a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isPublicIPAddress(java.lang.String)" class="member-name-link">isPublicIPAddress</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;ip)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a string expected to be an public IP address:

Is a valid IP v4 or v6 address.
Is public from an Internet perspective.

<br>
<b>Note:</b> I often see missing such validation in the value read from HTTP request headers like "X-Forwarded-For" or "Forwarded".</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isRegexSafe(java.lang.String,java.lang.String,java.util.Optional)" class="member-name-link">isRegexSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;regex,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;data,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&nbsp;maximumRunningTimeInSeconds)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a validations on a regular expression to ensure that is not prone to the ReDOS attack.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isRelativeURL(java.lang.String)" class="member-name-link">isRelativeURL</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;targetUrl)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Validate that the URL provided is really a relative URL.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isWeakPINCode(java.lang.String)" class="member-name-link">isWeakPINCode</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;pinCode)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validation to verify if a provided PIN code is considered weak (easy to guess) or none.<br>
This method consider that format of the PIN code is [0-9]{6,}<br>
Rule to consider a PIN code as weak:

Length is inferior to 6 positions.
Contain only the same number or only a sequence of zero.
Contain sequence of following incremental or decremental numbers.
</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isWord972003DocumentSafe(java.lang.String)" class="member-name-link">isWord972003DocumentSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;wordFilePath)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a Word 97-2003 (binary format) document file provided:

Real Microsoft Word 97-2003 document file.
No VBA Macro.<br>
No embedded objects.
</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isXMLHaveCommentsOrXSLProcessingInstructions(java.lang.String)" class="member-name-link">isXMLHaveCommentsOrXSLProcessingInstructions</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;xmlFilePath)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Identify if an XML contains any XML comments or have any XSL processing instructions.<br>
Stream reader based parsing is used to support large XML tree.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isXMLOnlyUseAllowedXSDorDTD(java.lang.String,java.util.List)" class="member-name-link">isXMLOnlyUseAllowedXSDorDTD</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;xmlFilePath,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;allowedSystemIdentifiers)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Ensure that an XML file only uses DTD/XSD references (called System Identifier) present in the allowed list provided.<br><br>
The code is based on the validation implemented into the OpenJDK 21, by the class <b><a href="https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.prefs/share/classes/java/util/prefs/XmlSupport.java">java.util.prefs.XmlSupport</a></b>, in the method <b><a href="https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.prefs/share/classes/java/util/prefs/XmlSupport.java#L240">loadPrefsDoc()</a></b>.<br><br>
The method also ensure that no Public Identifier is used to prevent potential bypasses of the validations.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isXMLSafe(java.lang.String)" class="member-name-link">isXMLSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;xmlFilePath)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Ensure that an XML file does not contain any External Entity, DTD or XInclude instructions.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isXSDSafe(java.lang.String)" class="member-name-link">isXSDSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;xsdFilePath)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Ensure that an XSD file does not contain any include/import/redefine instruction (prevent exposure to SSRF).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#isZIPSafe(java.lang.String,int,boolean)" class="member-name-link">isZIPSafe</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;zipFilePath,
 int&nbsp;maxLevelDeepness,
 boolean&nbsp;rejectArchiveFile)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Apply a collection of validations on a ZIP file provided:

Real ZIP file.
Contain less than a specified level of deepness.
Do not contain Zip-Slip entry path.
</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#sanitizeFile(java.lang.String,eu.righettod.InputFileType)" class="member-name-link">sanitizeFile</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;inputFilePath,
 <a href="InputFileType.html" title="enum class in eu.righettod">InputFileType</a>&nbsp;inputFileType)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Rewrite the input file to remove any embedded files that is not embedded using a methods supported by the official format of the file.<br>
Example: a file can be embedded by adding it to the end of the source file, see the reference provided for details.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#method-summary" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="isWeakPINCode(java.lang.String)">
<h3>isWeakPINCode</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-113">isWeakPINCode</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;pinCode)</span></div>
<div class="block">Apply a collection of validation to verify if a provided PIN code is considered weak (easy to guess) or none.<br>
This method consider that format of the PIN code is [0-9]{6,}<br>
Rule to consider a PIN code as weak:
<ul>
<li>Length is inferior to 6 positions.</li>
<li>Contain only the same number or only a sequence of zero.</li>
<li>Contain sequence of following incremental or decremental numbers.</li>
</ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>pinCode</code> - PIN code to verify.</dd>
<dt>Returns:</dt>
<dd>True only if the PIN is considered as weak.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isWord972003DocumentSafe(java.lang.String)">
<h3>isWord972003DocumentSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-161">isWord972003DocumentSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;wordFilePath)</span></div>
<div class="block">Apply a collection of validations on a Word 97-2003 (binary format) document file provided:
<ul>
<li>Real Microsoft Word 97-2003 document file.</li>
<li>No VBA Macro.<br></li>
<li>No embedded objects.</li>
</ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>wordFilePath</code> - Filename of the Word document file to check.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://poi.apache.org/components/"</li>
<li>"https://poi.apache.org/components/document/"</li>
<li>"https://poi.apache.org/components/poifs/how-to.html"</li>
<li>"https://poi.apache.org/components/poifs/embeded.html"</li>
<li>"https://poi.apache.org/"</li>
<li>"https://mvnrepository.com/artifact/org.apache.poi/poi"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isXMLSafe(java.lang.String)">
<h3>isXMLSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-220">isXMLSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;xmlFilePath)</span></div>
<div class="block">Ensure that an XML file does not contain any External Entity, DTD or XInclude instructions.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>xmlFilePath</code> - Filename of the XML file to check.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://portswigger.net/web-security/xxe"</li>
<li>"https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java"</li>
<li>"https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-82F8C206-F2DF-4204-9544-F96155B1D258"</li>
<li>"https://www.w3.org/TR/xinclude-11/"</li>
<li>"https://en.wikipedia.org/wiki/XInclude"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="extractAllPDFLinks(java.lang.String)">
<h3>extractAllPDFLinks</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/net/URL.html" title="class or interface in java.net" class="external-link">URL</a>&gt;</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-259">extractAllPDFLinks</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;pdfFilePath)</span>
                                    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></span></div>
<div class="block">Extract all URL links from a PDF file provided.<br>
This can be used to apply validation on a PDF against contained links.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>pdfFilePath</code> - pdfFilePath Filename of the PDF file to process.</dd>
<dt>Returns:</dt>
<dd>A List of URL objects that is empty if no links is found.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></code> - If any error occurs during the processing of the PDF file.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://www.gushiciku.cn/pl/21KQ"</li>
<li>"https://pdfbox.apache.org/"</li>
<li>"https://mvnrepository.com/artifact/org.apache.pdfbox/pdfbox"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isPDFSafe(java.lang.String)">
<h3>isPDFSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-316">isPDFSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;pdfFilePath)</span></div>
<div class="block">Apply a collection of validations on a PDF file provided:
<ul>
<li>Real PDF file.</li>
<li>No attachments.</li>
<li>No Javascript code.</li>
<li>No links using action of type URI/Launch/RemoteGoTo/ImportData.</li>
<li>No XFA forms in order to prevent exposure to XXE/SSRF like CVE-2025-54988.</li>
</ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>pdfFilePath</code> - Filename of the PDF file to check.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://stackoverflow.com/a/36161267"</li>
<li>"https://www.gushiciku.cn/pl/21KQ"</li>
<li>"https://github.com/jonaslejon/malicious-pdf"</li>
<li>"https://pdfbox.apache.org/"</li>
<li>"https://mvnrepository.com/artifact/org.apache.pdfbox/pdfbox"</li>
<li>"https://nvd.nist.gov/vuln/detail/CVE-2025-54988"</li>
<li>"https://github.com/mgthuramoemyint/POC-CVE-2025-54988"</li>
<li>"https://en.wikipedia.org/wiki/XFA"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="clearPDFMetadata(org.apache.pdfbox.pdmodel.PDDocument)">
<h3>clearPDFMetadata</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-378">clearPDFMetadata</a></span><wbr><span class="parameters">(org.apache.pdfbox.pdmodel.PDDocument&nbsp;document)</span></div>
<div class="block">Remove as much as possible metadata from the provided PDF document object.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>document</code> - PDFBox PDF document object on which metadata must be removed.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://gist.github.com/righettod/d7e07443c43d393a39de741a0d920069"</li>
<li>"https://pdfbox.apache.org/"</li>
<li>"https://mvnrepository.com/artifact/org.apache.pdfbox/pdfbox"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isRelativeURL(java.lang.String)">
<h3>isRelativeURL</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-396">isRelativeURL</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;targetUrl)</span></div>
<div class="block">Validate that the URL provided is really a relative URL.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>targetUrl</code> - URL to validate.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://portswigger.net/web-security/ssrf"</li>
<li>"https://stackoverflow.com/q/6785442"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isZIPSafe(java.lang.String,int,boolean)">
<h3>isZIPSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-435">isZIPSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;zipFilePath,
 int&nbsp;maxLevelDeepness,
 boolean&nbsp;rejectArchiveFile)</span></div>
<div class="block">Apply a collection of validations on a ZIP file provided:
<ul>
<li>Real ZIP file.</li>
<li>Contain less than a specified level of deepness.</li>
<li>Do not contain Zip-Slip entry path.</li>
</ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>zipFilePath</code> - Filename of the ZIP file to check.</dd>
<dd><code>maxLevelDeepness</code> - Threshold of deepness above which a ZIP archive will be rejected.</dd>
<dd><code>rejectArchiveFile</code> - Flag to specify if presence of any archive entry will cause the rejection of the ZIP file.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://rules.sonarsource.com/java/type/Security%20Hotspot/RSPEC-5042"</li>
<li>"https://security.snyk.io/research/zip-slip-vulnerability"</li>
<li>"https://en.wikipedia.org/wiki/Zip_bomb"</li>
<li>"https://github.com/ptoomey3/evilarc"</li>
<li>"https://github.com/abdulfatir/ZipBomb"</li>
<li>"https://www.baeldung.com/cs/zip-bomb"</li>
<li>"https://thesecurityvault.com/attacks-with-zip-files-and-mitigations/"</li>
<li>"https://wiki.sei.cmu.edu/confluence/display/java/IDS04-J.+Safely+extract+files+from+ZipInputStream"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="identifyMimeType(byte[])">
<h3>identifyMimeType</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-499">identifyMimeType</a></span><wbr><span class="parameters">(byte[]&nbsp;content)</span></div>
<div class="block">Identify the mime type of the content specified (array of bytes).<br>
Note that it cannot be fully trusted (see the tweet '1595824709186519041' referenced), so, additional validations are required.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>content</code> - The content as an array of bytes.</dd>
<dt>Returns:</dt>
<dd>The mime type in lower case or null if it cannot be identified.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://twitter.com/righettod/status/1595824709186519041"</li>
<li>"https://tika.apache.org/"</li>
<li>"https://mvnrepository.com/artifact/org.apache.tika/tika-core"</li>
<li>"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types"</li>
<li>"https://www.iana.org/assignments/media-types/media-types.xhtml"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isPublicIPAddress(java.lang.String)">
<h3>isPublicIPAddress</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-549">isPublicIPAddress</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;ip)</span></div>
<div class="block">Apply a collection of validations on a string expected to be an public IP address:
<ul>
<li>Is a valid IP v4 or v6 address.</li>
<li>Is public from an Internet perspective.</li>
</ul>
<br>
<b>Note:</b> I often see missing such validation in the value read from HTTP request headers like "X-Forwarded-For" or "Forwarded".
<br><br>
<b>Note for IPv6:</b> I used documentation found so it is really experimental!</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>ip</code> - String expected to be a valid IP address.</dd>
<dt>Returns:</dt>
<dd>True only if the string pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://commons.apache.org/proper/commons-validator/"</li>
<li>"https://commons.apache.org/proper/commons-validator/apidocs/org/apache/commons/validator/routines/InetAddressValidator.html"</li>
<li>"https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"</li>
<li>"https://cheatsheetseries.owasp.org/assets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet_Orange_Tsai_Talk.pdf"</li>
<li>"https://cheatsheetseries.owasp.org/assets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet_SSRF_Bible.pdf"</li>
<li>"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For"</li>
<li>"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Forwarded"</li>
<li>"https://ipcisco.com/lesson/ipv6-address/"</li>
<li>"https://www.juniper.net/documentation/us/en/software/junos/interfaces-security-devices/topics/topic-map/security-interface-ipv4-ipv6-protocol.html"</li>
<li>"https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/net/InetAddress.html#getByName(java.lang.String)"</li>
<li>"https://www.arin.net/reference/research/statistics/address_filters/"</li>
<li>"https://en.wikipedia.org/wiki/Multicast_address"</li>
<li>"https://stackoverflow.com/a/5619409"</li>
<li>"https://www.ripe.net/media/documents/ipv6-address-types.pdf"</li>
<li>"https://www.iana.org/assignments/ipv6-unicast-address-assignments/ipv6-unicast-address-assignments.xhtml"</li>
<li>"https://developer.android.com/reference/java/net/Inet6Address"</li>
<li>"https://en.wikipedia.org/wiki/Unique_local_address"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="computeHashNoProneToAbuseOnParts(java.util.List)">
<h3>computeHashNoProneToAbuseOnParts</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-612">computeHashNoProneToAbuseOnParts</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;parts)</span>
                                               throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></span></div>
<div class="block">Compute a SHA256 hash from an input composed of a collection of strings.<br><br>
This method take care to build the source string in a way to prevent this source string to be prone to abuse targeting the different parts composing it.<br><br>
<p>
Example of possible abuse without precautions applied during the hash calculation logic:<br>
Hash of <code>SHA256("Hello", "My", "World!!!")</code> will be equals to the hash of <code>SHA256("Hell", "oMyW", "orld!!!")</code>.<br>
</p>
This method ensure that both hash above will be different.<br><br>

<b>Note:</b> The character <code>|</code> is used, as separator, of every parts so a part is not allowed to contains this character.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>parts</code> - Ordered list of strings to use to build the input string for which the hash must be computed on. No null value is accepted on object composing the collection.</dd>
<dt>Returns:</dt>
<dd>The hash, as an array of bytes, to allow caller to convert it to the final representation wanted (HEX, Base64, etc.). If the collection passed is null or empty then the method return null.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></code> - If any exception occurs</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://github.com/righettod/code-snippets-security-utils/issues/16"</li>
<li>"https://pentesterlab.com/badges/codereview"</li>
<li>"https://blog.trailofbits.com/2024/08/21/yolo-is-not-a-valid-hash-construction/"</li>
<li>"https://www.nist.gov/publications/sha-3-derived-functions-cshake-kmac-tuplehash-and-parallelhash"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isXMLOnlyUseAllowedXSDorDTD(java.lang.String,java.util.List)">
<h3>isXMLOnlyUseAllowedXSDorDTD</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-649">isXMLOnlyUseAllowedXSDorDTD</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;xmlFilePath,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;allowedSystemIdentifiers)</span></div>
<div class="block">Ensure that an XML file only uses DTD/XSD references (called System Identifier) present in the allowed list provided.<br><br>
The code is based on the validation implemented into the OpenJDK 21, by the class <b><a href="https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.prefs/share/classes/java/util/prefs/XmlSupport.java">java.util.prefs.XmlSupport</a></b>, in the method <b><a href="https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.prefs/share/classes/java/util/prefs/XmlSupport.java#L240">loadPrefsDoc()</a></b>.<br><br>
The method also ensure that no Public Identifier is used to prevent potential bypasses of the validations.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>xmlFilePath</code> - Filename of the XML file to check.</dd>
<dd><code>allowedSystemIdentifiers</code> - List of URL allowed for System Identifier specified for any XSD/DTD references.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://www.w3schools.com/xml/prop_documenttype_systemid.asp"</li>
<li>"https://www.ibm.com/docs/en/integration-bus/9.0.0?topic=doctypedecl-xml-systemid"</li>
<li>"https://www.liquid-technologies.com/Reference/Glossary/XML_DocType.html"</li>
<li>"https://www.xml.com/pub/98/08/xmlqna0.html"</li>
<li>"https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.prefs/share/classes/java/util/prefs/XmlSupport.java#L397"</li>
<li>"https://en.wikipedia.org/wiki/Formal_Public_Identifier"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isExcelCSVSafe(java.lang.String)">
<h3>isExcelCSVSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-709">isExcelCSVSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;csvFilePath)</span></div>
<div class="block">Apply a collection of validations on a EXCEL CSV file provided (file was expected to be opened in Microsoft EXCEL):
<ul>
<li>Real CSV file.</li>
<li>Do not contains any payload related to a CSV injections.</li>
</ul>
Ensure that, if Apache Commons CSV does not find any record then, the file will be considered as NOT safe (prevent potential bypasses).<br><br>
<b>Note:</b> Record delimiter used is the <code>,</code> (comma) character. See the Apache Commons CSV reference provided for EXCEL.<br></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>csvFilePath</code> - Filename of the CSV file to check.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://commons.apache.org/proper/commons-csv/"</li>
<li>"https://commons.apache.org/proper/commons-csv/apidocs/org/apache/commons/csv/CSVFormat.html#EXCEL"</li>
<li>"https://www.we45.com/post/your-excel-sheets-are-not-safe-heres-how-to-beat-csv-injection"</li>
<li>"https://www.whiteoaksecurity.com/blog/2020-4-23-csv-injection-whats-the-risk/"</li>
<li>"https://book.hacktricks.xyz/pentesting-web/formula-csv-doc-latex-ghostscript-injection"</li>
<li>"https://owasp.org/www-community/attacks/CSV_Injection"</li>
<li>"https://payatu.com/blog/csv-injection-basic-to-exploit/"</li>
<li>"https://cwe.mitre.org/data/definitions/1236.html"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="ensureSerializedObjectIntegrity(eu.righettod.ProcessingModeType,java.lang.String,byte[])">
<h3>ensureSerializedObjectIntegrity</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-753">ensureSerializedObjectIntegrity</a></span><wbr><span class="parameters">(<a href="ProcessingModeType.html" title="enum class in eu.righettod">ProcessingModeType</a>&nbsp;processingModeType,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;input,
 byte[]&nbsp;secret)</span>
                                                          throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></span></div>
<div class="block">Provide a way to add an integrity marker (<a href="https://en.wikipedia.org/wiki/HMAC">HMAC</a>) to a serialized object serialized using the <a href="https://www.baeldung.com/java-serialization">java native system</a> (binary).<br>
The goal is to provide <b>a temporary workaround</b> to try to prevent deserialization attacks and give time to move to a text-based serialization approach.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>processingModeType</code> - Define the mode of processing i.e. protect or validate. (<a href="ProcessingModeType.html" title="enum class in eu.righettod"><code>ProcessingModeType</code></a>)</dd>
<dd><code>input</code> - When the processing mode is "protect" than the expected input (string) is a java serialized object encoded in Base64 otherwise (processing mode is "validate") expected input is the output of this method when the "protect" mode was used.</dd>
<dd><code>secret</code> - Secret to use to compute the SHA256 HMAC.</dd>
<dt>Returns:</dt>
<dd>A map with the following keys: <ul><li><b>PROCESSING_MODE</b>: Processing mode used to compute the result.</li><li><b>STATUS</b>: A boolean indicating if the processing was successful or not.</li><li><b>RESULT</b>: Always contains a string representing the protected serialized object in the format <code>[SERIALIZED_OBJECT_BASE64_ENCODED]:[SERIALIZED_OBJECT_HMAC_BASE64_ENCODED]</code>.</li></ul></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></code> - If any exception occurs.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html"</li>
<li>"https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization"</li>
<li>"https://portswigger.net/web-security/deserialization"</li>
<li>"https://www.baeldung.com/java-serialization-approaches"</li>
<li>"https://www.baeldung.com/java-serialization"</li>
<li>"https://cryptobook.nakov.com/mac-and-key-derivation/hmac-and-key-derivation"</li>
<li>"https://en.wikipedia.org/wiki/HMAC"</li>
<li>"https://smattme.com/posts/how-to-generate-hmac-signature-in-java/"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isJSONSafe(java.lang.String,int,int)">
<h3>isJSONSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-828">isJSONSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;json,
 int&nbsp;maxItemsByArraysCount,
 int&nbsp;maxDeepnessAllowed)</span></div>
<div class="block">Apply a collection of validations on a JSON string provided:
<ul>
<li>Real JSON structure.</li>
<li>Contain less than a specified number of deepness for nested objects or arrays.</li>
<li>Contain less than a specified number of items in any arrays.</li>
</ul>
<br>
<b>Note:</b> I decided to use a parsing approach using only string processing to prevent any StackOverFlow or OutOfMemory error that can be abused.<br><br>
I used the following assumption:
<ul>
     <li>The character <code>{</code> identify the beginning of an object.</li>
     <li>The character <code>}</code> identify the end of an object.</li>
     <li>The character <code>[</code> identify the beginning of an array.</li>
     <li>The character <code>]</code> identify the end of an array.</li>
     <li>The character <code>"</code> identify the delimiter of a string.</li>
     <li>The character sequence <code>\"</code> identify the escaping of an double quote.</li>
</ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>json</code> - String containing the JSON data to validate.</dd>
<dd><code>maxItemsByArraysCount</code> - Maximum number of items allowed in an array.</dd>
<dd><code>maxDeepnessAllowed</code> - Maximum number nested objects or arrays allowed.</dd>
<dt>Returns:</dt>
<dd>True only if the string pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://javaee.github.io/jsonp/"</li>
<li>"https://community.f5.com/discussions/technicalforum/disable-buffer-overflow-in-json-parameters/124306"</li>
<li>"https://github.com/InductiveComputerScience/pbJson/issues/2"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isImageSafe(java.lang.String,java.util.List)">
<h3>isImageSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-938">isImageSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;imageFilePath,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;imageAllowedMimeTypes)</span></div>
<div class="block">Apply a collection of validations on a image file provided:
<ul>
<li>Real image file.</li>
<li>Its mime type is into the list of allowed mime types.</li>
<li>Its metadata fields do not contains any characters related to a malicious payloads.</li>
</ul>
<br>
<b>Important note:</b> This implementation is prone to bypass using the "<b>raw insertion</b>" method documented in the <a href="https://www.synacktiv.com/en/publications/persistent-php-payloads-in-pngs-how-to-inject-php-code-in-an-image-and-keep-it-there">blog post</a> from the Synacktiv team.
To handle such case, it is recommended to resize the image to remove any non image-related content, see <a href="https://github.com/righettod/document-upload-protection/blob/master/src/main/java/eu/righettod/poc/sanitizer/ImageDocumentSanitizerImpl.java#L54">here</a> for an example.<br></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>imageFilePath</code> - Filename of the image file to check.</dd>
<dd><code>imageAllowedMimeTypes</code> - List of image mime types allowed.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://commons.apache.org/proper/commons-imaging/"</li>
<li>"https://commons.apache.org/proper/commons-imaging/formatsupport.html"</li>
<li>"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types"</li>
<li>"https://www.iana.org/assignments/media-types/media-types.xhtml#image"</li>
<li>"https://www.synacktiv.com/en/publications/persistent-php-payloads-in-pngs-how-to-inject-php-code-in-an-image-and-keep-it-there"</li>
<li>"https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html"</li>
<li>"https://github.com/righettod/document-upload-protection/blob/master/src/main/java/eu/righettod/poc/sanitizer/ImageDocumentSanitizerImpl.java"</li>
<li>"https://exiftool.org/examples.html"</li>
<li>"https://en.wikipedia.org/wiki/List_of_file_signatures"</li>
<li>"https://hexed.it/"</li>
<li>"https://github.com/sighook/pixload"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="sanitizeFile(java.lang.String,eu.righettod.InputFileType)">
<h3>sanitizeFile</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-986">sanitizeFile</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;inputFilePath,
 <a href="InputFileType.html" title="enum class in eu.righettod">InputFileType</a>&nbsp;inputFileType)</span>
                           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></span></div>
<div class="block">Rewrite the input file to remove any embedded files that is not embedded using a methods supported by the official format of the file.<br>
Example: a file can be embedded by adding it to the end of the source file, see the reference provided for details.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>inputFilePath</code> - Filename of the file to clean up.</dd>
<dd><code>inputFileType</code> - Type of the file provided.</dd>
<dt>Returns:</dt>
<dd>A array of bytes with the cleaned file.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - If an invalid parameter is passed</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></code> - If any technical error during the cleaning processing</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://www.synacktiv.com/en/publications/persistent-php-payloads-in-pngs-how-to-inject-php-code-in-an-image-and-keep-it-there"</li>
<li>"https://github.com/righettod/toolbox-pentest-web/tree/master/misc"</li>
<li>"https://github.com/righettod/toolbox-pentest-web?tab=readme-ov-file#misc"</li>
<li>"https://stackoverflow.com/a/13605411"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isEmailAddress(java.lang.String)">
<h3>isEmailAddress</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1057">isEmailAddress</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;addr)</span></div>
<div class="block">Apply a collection of validations on a string expected to be an email address:
<ul>
<li>Is a valid email address, from a parser perspective, following RFCs on email addresses.</li>
<li>Is not using "Encoded-word" format.</li>
<li>Is not using comment format.</li>
<li>Is not using "Punycode" format.</li>
<li>Is not using UUCP style addresses.</li>
<li>Is not using address literals.</li>
<li>Is not using source routes.</li>
<li>Is not using the "percent hack".</li>
</ul><br>
This is based on the research work from <a href="https://portswigger.net/research/gareth-heyes">Gareth Heyes</a> added in references (Portswigger).<br><br>

<b>Note:</b> The notion of valid, here, is to take from a secure usage of the data perspective.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>addr</code> - String expected to be a valid email address.</dd>
<dt>Returns:</dt>
<dd>True only if the string pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://commons.apache.org/proper/commons-validator/"</li>
<li>"https://commons.apache.org/proper/commons-validator/apidocs/org/apache/commons/validator/routines/EmailValidator.html"</li>
<li>"https://datatracker.ietf.org/doc/html/rfc2047#section-2"</li>
<li>"https://portswigger.net/research/splitting-the-email-atom"</li>
<li>"https://www.jochentopf.com/email/address.html"</li>
<li>"https://en.wikipedia.org/wiki/Email_address"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isPSD2StetSafeCertificateURL(java.lang.String)">
<h3>isPSD2StetSafeCertificateURL</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1109">isPSD2StetSafeCertificateURL</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;certificateUrl)</span></div>
<div class="block">The <a href="https://www.stet.eu/en/psd2/">PSD2 STET</a> specification require to use <a href="https://datatracker.ietf.org/doc/draft-cavage-http-signatures/">HTTP Signature</a>.
<br>
Section <b>3.5.1.2</b> of the document <a href="https://www.stet.eu/assets/files/PSD2/1-6-3/api-dsp2-stet-v1.6.3.1-part-1-framework.pdf">Documentation Framework</a> version <b>1.6.3</b>.
<br>
The problem is that, by design, the HTTP Signature specification is prone to blind SSRF.
<br>
URL example taken from the STET specification: <code>https://path.to/myQsealCertificate_714f8154ec259ac40b8a9786c9908488b2582b68b17e865fede4636d726b709f</code>.
<br>
The objective of this code is to try to decrease the "exploitability/interest" of this SSRF for an attacker.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>certificateUrl</code> - Url pointing to a Qualified Certificate (QSealC) encoded in PEM format and respecting the ETSI/TS119495 technical Specification .</dd>
<dt>Returns:</dt>
<dd>TRUE only if the url point to a Qualified Certificate in PEM format.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://www.stet.eu/en/psd2/"</li>
<li>"https://www.stet.eu/assets/files/PSD2/1-6-3/api-dsp2-stet-v1.6.3.1-part-1-framework.pdf"</li>
<li>"https://datatracker.ietf.org/doc/draft-cavage-http-signatures/"</li>
<li>"https://datatracker.ietf.org/doc/rfc9421/"</li>
<li>"https://openjdk.org/groups/net/httpclient/intro.html"</li>
<li>"https://docs.oracle.com/en/java/javase/21/docs/api/java.net.http/java/net/http/package-summary.html"</li>
<li>"https://portswigger.net/web-security/ssrf"</li>
<li>"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="applyURLDecoding(java.lang.String,int)">
<h3>applyURLDecoding</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1161">applyURLDecoding</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;encodedData,
 int&nbsp;decodingRoundThreshold)</span>
                               throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/SecurityException.html" title="class or interface in java.lang" class="external-link">SecurityException</a></span></div>
<div class="block">Perform sequential URL decoding operations against a URL encoded data until the data is not URL encoded anymore or if the specified threshold is reached.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>encodedData</code> - URL encoded data.</dd>
<dd><code>decodingRoundThreshold</code> - Threshold above which decoding will fail.</dd>
<dt>Returns:</dt>
<dd>The decoded data.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/SecurityException.html" title="class or interface in java.lang" class="external-link">SecurityException</a></code> - If the threshold is reached.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://en.wikipedia.org/wiki/Percent-encoding"</li>
<li>"https://owasp.org/www-community/Double_Encoding"</li>
<li>"https://portswigger.net/web-security/essential-skills/obfuscating-attacks-using-encodings"</li>
<li>"https://capec.mitre.org/data/definitions/120.html"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isPathSafe(java.lang.String)">
<h3>isPathSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1199">isPathSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;path)</span></div>
<div class="block">Apply a collection of validations on a string expected to be an system file/folder path:
<ul>
<li>Does not contains path traversal payload.</li>
<li>The canonical path is equals to the absolute path.</li>
</ul><br></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>path</code> - String expected to be a valid system file/folder path.</dd>
<dt>Returns:</dt>
<dd>True only if the string pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://portswigger.net/web-security/file-path-traversal"</li>
<li>"https://learn.snyk.io/lesson/directory-traversal/"</li>
<li>"https://capec.mitre.org/data/definitions/126.html"</li>
<li>"https://owasp.org/www-community/attacks/Path_Traversal"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isXMLHaveCommentsOrXSLProcessingInstructions(java.lang.String)">
<h3>isXMLHaveCommentsOrXSLProcessingInstructions</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1231">isXMLHaveCommentsOrXSLProcessingInstructions</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;xmlFilePath)</span></div>
<div class="block">Identify if an XML contains any XML comments or have any XSL processing instructions.<br>
Stream reader based parsing is used to support large XML tree.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>xmlFilePath</code> - Filename of the XML file to check.</dd>
<dt>Returns:</dt>
<dd>True only if XML comments or XSL processing instructions are identified.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://www.tutorialspoint.com/xml/xml_processing.htm"</li>
<li>"https://docs.oracle.com/en/java/javase/21/docs/api/java.xml/javax/xml/stream/XMLInputFactory.html"</li>
<li>"https://portswigger.net/kb/issues/00400700_xml-entity-expansion"</li>
<li>"https://www.w3.org/Style/styling-XML.en.html"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="applyJWTExtraValidation(com.auth0.jwt.interfaces.DecodedJWT,eu.righettod.TokenType,java.util.List)">
<h3>applyJWTExtraValidation</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1284">applyJWTExtraValidation</a></span><wbr><span class="parameters">(com.auth0.jwt.interfaces.DecodedJWT&nbsp;token,
 <a href="TokenType.html" title="enum class in eu.righettod">TokenType</a>&nbsp;expectedTokenType,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;revokedTokenJTIList)</span></div>
<div class="block">Perform a set of additional validations against a JWT token:
<ul>
    <li>Do not use the <b>NONE</b> signature algorithm.</li>
    <li>Have a <a href="https://www.iana.org/assignments/jwt/jwt.xhtml">EXP claim</a> defined.</li>
    <li>The token identifier (<a href="https://www.iana.org/assignments/jwt/jwt.xhtml">JTI claim</a>) is NOT part of the list of revoked token.</li>
    <li>Match the expected type of token: ACCESS or ID or REFRESH.</li>
</ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>token</code> - JWT token for which <b>signature was already validated</b> and on which a set of additional validations will be applied.</dd>
<dd><code>expectedTokenType</code> - The type of expected token using the enumeration provided.</dd>
<dd><code>revokedTokenJTIList</code> - A list of token identifier (<b>JTI</b> claim) referring to tokens that were revoked and to which the JTI claim of the token will be compared to.</dd>
<dt>Returns:</dt>
<dd>True only the token pass all the validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://www.iana.org/assignments/jwt/jwt.xhtml"</li>
<li>"https://auth0.com/docs/secure/tokens/access-tokens"</li>
<li>"https://auth0.com/docs/secure/tokens/id-tokens"</li>
<li>"https://auth0.com/docs/secure/tokens/refresh-tokens"</li>
<li>"https://auth0.com/blog/id-token-access-token-what-is-the-difference/"</li>
<li>"https://jwt.io/libraries?language=Java"</li>
<li>"https://pentesterlab.com/blog/secure-jwt-library-design"</li>
<li>"https://github.com/auth0/java-jwt"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isRegexSafe(java.lang.String,java.lang.String,java.util.Optional)">
<h3>isRegexSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1331">isRegexSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;regex,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;data,
 <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&nbsp;maximumRunningTimeInSeconds)</span></div>
<div class="block">Apply a validations on a regular expression to ensure that is not prone to the ReDOS attack.
<br>If your technology is supported by <a href="https://github.com/doyensec/regexploit">regexploit</a> then <b>use it instead of this method!</b>
<br>Indeed, the <a href="https://www.doyensec.com/">Doyensec</a> team has made an intensive and amazing work on this topic and created this effective tool.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>regex</code> - String expected to be a valid regular expression (regex).</dd>
<dd><code>data</code> - Test data on which the regular expression is executed for the test.</dd>
<dd><code>maximumRunningTimeInSeconds</code> - Optional parameter to specify a number of seconds above which a regex execution time is considered as not safe (default to 4 seconds when not specified).</dd>
<dt>Returns:</dt>
<dd>True only if the string pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://github.blog/security/how-to-fix-a-redos/"</li>
<li>"https://learn.snyk.io/lesson/redos"</li>
<li>"https://rules.sonarsource.com/java/RSPEC-2631/"</li>
<li>"https://github.com/doyensec/regexploit"</li>
<li>"https://wiki.owasp.org/images/2/23/OWASP_IL_2009_ReDoS.pdf"</li>
<li>"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="computeUUIDv7()">
<h3>computeUUIDv7</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/UUID.html" title="class or interface in java.util" class="external-link">UUID</a></span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1383">computeUUIDv7</a></span>()</div>
<div class="block">Compute a UUID version 7 without using any external dependency.<br><br>
<b>Below are my personal point of view and perhaps I'm totally wrong!</b>
<br><br>
Why such method?
<ul>
<li>Java inferior or equals to 21 does not supports natively the generation of an UUID version 7.</li>
<li>Import a library just to generate such value is overkill for me.</li>
<li>Library that I have found, generating such version of an UUID, are not provided by entities commonly used in the java world, such as the SPRING framework provider.</li>
</ul>
<br>
<b>Full credits for this implementation goes to the authors and contributors of the <a href="https://github.com/nalgeon/uuidv7">UUIDv7</a> project.</b>
<br><br>
Below are the java libraries that I have found but, for which, I do not trust enough the provider to use them directly:
<ul>
    <li><a href="https://github.com/cowtowncoder/java-uuid-generator">java-uuid-generator</a></li>
    <li><a href="https://github.com/f4b6a3/uuid-creator">uuid-creator</a></li>
</ul></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>A UUID object representing the UUID v7.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://uuid7.com/"</li>
<li>"https://antonz.org/uuidv7/"</li>
<li>"https://mccue.dev/pages/3-11-25-life-altering-postgresql-patterns"</li>
<li>"https://www.ietf.org/archive/id/draft-peabody-dispatch-new-uuid-format-04.html#name-uuid-version-7"</li>
<li>"https://www.baeldung.com/java-generating-time-based-uuids"</li>
<li>"https://en.wikipedia.org/wiki/Universally_unique_identifier"</li>
<li>"https://buildkite.com/resources/blog/goodbye-integers-hello-uuids/"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isXSDSafe(java.lang.String)">
<h3>isXSDSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1416">isXSDSafe</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;xsdFilePath)</span></div>
<div class="block">Ensure that an XSD file does not contain any include/import/redefine instruction (prevent exposure to SSRF).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>xsdFilePath</code> - Filename of the XSD file to check.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://portswigger.net/web-security/ssrf"</li>
<li>"https://www.w3schools.com/Xml/el_import.asp"</li>
<li>"https://www.w3schools.com/xml/el_include.asp"</li>
<li>"https://www.linkedin.com/posts/righettod_appsec-appsecurity-java-activity-7344048434326188053-6Ru9"</li>
<li>"https://docs.oracle.com/en/java/javase/21/docs/api/java.xml/javax/xml/validation/SchemaFactory.html#setProperty(java.lang.String,java.lang.Object)"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="extractAllSensitiveInformation(java.lang.String)">
<h3>extractAllSensitiveInformation</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="SensitiveInformationType.html" title="enum class in eu.righettod">SensitiveInformationType</a>, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&gt;</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1459">extractAllSensitiveInformation</a></span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;content)</span>
                                                                                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></span></div>
<div class="block">Extract all sensitive information from a string provided.<br>
This can be used to identify any sensitive information into a <a href="https://cwe.mitre.org/data/definitions/532.html">message expected to be written in a log</a> and then replace every sensitive values by an obfuscated ones.<br><br>
For the luxembourg national identification number, this method focus on detecting identifiers for a physical entity (people) and not a moral one (company).<br><br>
I delegated the validation of the IBAN to a dedicated library (<a href="https://github.com/arturmkrtchyan/iban4j">iban4j</a>) to not "reinvent the wheel" and then introduce buggy validation myself. I used <b>iban4j</b> over the <b><a href="https://commons.apache.org/proper/commons-validator/apidocs/org/apache/commons/validator/routines/IBANValidator.html">IBANValidator</a></b> class from the <a href="https://commons.apache.org/proper/commons-validator/"><b>Apache Commons Validator</b></a> library because <b>iban4j</b> perform a full official IBAN specification validation so its reduce risks of false-positives by ensuring that an IBAN detected is a real IBAN.<br><br>
Same thing and reason regarding the validation of the bank card PAN using the  class <a href="https://commons.apache.org/proper/commons-validator/apidocs/org/apache/commons/validator/routines/CreditCardValidator.html">CreditCardValidator</a> from the <b>Apache Commons Validator</b> library.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>content</code> - String in which sensitive information must be searched.</dd>
<dt>Returns:</dt>
<dd>A map with the collection of identified sensitive information gathered by sensitive information type. If nothing is found then the map is empty. A type of sensitive information is only present if there is at least one item found. A set is used to not store duplicates occurrence of the same sensitive information.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></code> - If any error occurs during the processing.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://guichet.public.lu/en/citoyens/citoyennete/registre-national/identification/demande-numero-rnpp.html"</li>
<li>"https://cnpd.public.lu/fr/decisions-avis/2009/identifiant-unique.html"</li>
<li>"https://cnpd.public.lu/content/dam/cnpd/fr/decisions-avis/2009/identifiant-unique/48_2009.pdf"</li>
<li>"https://en.wikipedia.org/wiki/International_Bank_Account_Number"</li>
<li>"https://www.iban.com/structure"</li>
<li>"https://github.com/arturmkrtchyan/iban4j"</li>
<li>"https://cwe.mitre.org/data/definitions/532.html"</li>
<li>"https://www.baeldung.com/logback-mask-sensitive-data"</li>
<li>"https://en.wikipedia.org/wiki/Payment_card_number"</li>
<li>"https://commons.apache.org/proper/commons-validator/apidocs/org/apache/commons/validator/routines/CreditCardValidator.html"</li>
<li>"https://commons.apache.org/proper/commons-validator/"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isGZIPCompressedDataSafe(byte[],long)">
<h3>isGZIPCompressedDataSafe</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name"><a href="../../src-html/eu/righettod/SecurityUtils.html#line-1561">isGZIPCompressedDataSafe</a></span><wbr><span class="parameters">(byte[]&nbsp;compressedBytes,
 long&nbsp;maxCountOfDecompressedBytesAllowed)</span></div>
<div class="block">Apply a collection of validations on a bytes array provided representing GZIP compressed data:
<ul>
<li>Are valid GZIP compressed data.</li>
<li>The number of bytes once decompressed is under the specified limit.</li>
</ul>
<br><b>Note:</b> The value <code>Integer.MAX_VALUE - 8</code> was chosen because during my tests on Java 25 (JDK 64 bits on Windows 11 Pro), it was possible to decompress such amount of data with the default JVM settings without causing an <a href="https://docs.oracle.com/en/java/javase/25/docs/api//java.base/java/lang/OutOfMemoryError.html">Out Of Memory error</a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>compressedBytes</code> - Array of bytes containing the GZIP compressed data to check.</dd>
<dd><code>maxCountOfDecompressedBytesAllowed</code> - Maximum number of decompressed bytes allowed. Default to 10 MB if the specified value is inferior to 1 or superior to Integer.MAX_VALUE - 8.</dd>
<dt>Returns:</dt>
<dd>True only if the file pass all validations.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li>"https://en.wikipedia.org/wiki/Gzip"</li>
<li>"https://www.rapid7.com/db/modules/auxiliary/dos/http/gzip_bomb_dos/"</li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Generated on 2025-11-11 - <a href="https://github.com/righettod/code-snippets-security-utils">GitHub repository</a></small></p>
</footer>
</main>
</div>
</body>
</html>
