<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (21) on Sun Oct 27 09:24:36 UTC 2024 -->
<title>Index (Javadoc)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2024-10-27">
<meta name="description" content="index">
<meta name="generator" content="javadoc/IndexWriter">
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="script.js"></script>
<script type="text/javascript" src="script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="script-dir/jquery-ui.min.js"></script>
</head>
<body class="index-page">
<script type="text/javascript">var pathtoroot = "./";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="eu/righettod/package-summary.html">Package</a></li>
<li>Class</li>
<li>Use</li>
<li><a href="eu/righettod/package-tree.html">Tree</a></li>
<li class="nav-bar-cell1-rev">Index</li>
<li><a href="help-doc.html#index">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list"></div>
<div class="nav-list-search"><a href="search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<h1>Index</h1>
</div>
<a href="#I:A">A</a>&nbsp;<a href="#I:C">C</a>&nbsp;<a href="#I:E">E</a>&nbsp;<a href="#I:I">I</a>&nbsp;<a href="#I:P">P</a>&nbsp;<a href="#I:S">S</a>&nbsp;<a href="#I:V">V</a>&nbsp;<br><a href="allclasses-index.html">All&nbsp;Classes&nbsp;and&nbsp;Interfaces</a><span class="vertical-separator">|</span><a href="allpackages-index.html">All&nbsp;Packages</a>
<h2 class="title" id="I:A">A</h2>
<dl class="index">
<dt><a href="eu/righettod/SecurityUtils.html#applyURLDecoding(java.lang.String,int)" class="member-name-link">applyURLDecoding(String, int)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Perform sequential URL decoding operations against a URL encoded data until the data is not URL encoded anymore or if the specified threshold is reached.</div>
</dd>
</dl>
<h2 class="title" id="I:C">C</h2>
<dl class="index">
<dt><a href="eu/righettod/SecurityUtils.html#clearPDFMetadata(org.apache.pdfbox.pdmodel.PDDocument)" class="member-name-link">clearPDFMetadata(PDDocument)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Remove as much as possible metadata from the provided PDF document object.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#computeHashNoProneToAbuseOnParts(java.util.List)" class="member-name-link">computeHashNoProneToAbuseOnParts(List&lt;String&gt;)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Compute a SHA256 hash from an input composed of a collection of strings.<br><br>
 This method take care to build the source string in a way to prevent this source string to be prone to abuse targeting the different parts composing it.<br><br></div>
</dd>
</dl>
<h2 class="title" id="I:E">E</h2>
<dl class="index">
<dt><a href="eu/righettod/SecurityUtils.html#ensureSerializedObjectIntegrity(eu.righettod.ProcessingMode,java.lang.String,byte%5B%5D)" class="member-name-link">ensureSerializedObjectIntegrity(ProcessingMode, String, byte[])</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Provide a way to add an integrity marker (<a href="https://en.wikipedia.org/wiki/HMAC">HMAC</a>) to a serialized object serialized using the <a href="https://www.baeldung.com/java-serialization">java native system</a> (binary).<br>
 The goal is to provide <b>a temporary workaround</b> to try to prevent deserialization attacks and give time to move to a text-based serialization approach.</div>
</dd>
<dt><a href="eu/righettod/package-summary.html">eu.righettod</a> - package eu.righettod</dt>
<dd>&nbsp;</dd>
<dt><a href="eu/righettod/SecurityUtils.html#extractAllPDFLinks(java.lang.String)" class="member-name-link">extractAllPDFLinks(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Extract all URL links from a PDF file provided.<br>
 This can be used to apply validation on a PDF against contained links.</div>
</dd>
</dl>
<h2 class="title" id="I:I">I</h2>
<dl class="index">
<dt><a href="eu/righettod/SecurityUtils.html#identifyMimeType(byte%5B%5D)" class="member-name-link">identifyMimeType(byte[])</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Identify the mime type of the content specified (array of bytes).<br>
 Note that it cannot be fully trusted (see the tweet '1595824709186519041' referenced), so, additional validations are required.</div>
</dd>
<dt><a href="eu/righettod/InputFileType.html#IMAGE" class="member-name-link">IMAGE</a> - Enum constant in enum class eu.righettod.<a href="eu/righettod/InputFileType.html" title="enum class in eu.righettod">InputFileType</a></dt>
<dd>
<div class="block">Image: PNG, GIF, ...</div>
</dd>
<dt><a href="eu/righettod/InputFileType.html" class="type-name-link" title="enum class in eu.righettod">InputFileType</a> - Enum Class in <a href="eu/righettod/package-summary.html">eu.righettod</a></dt>
<dd>
<div class="block">Enumeration used by the method <code>SecurityUtils.sanitizeFile()</code> to define the type of file to sanitize.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isEmailAddress(java.lang.String)" class="member-name-link">isEmailAddress(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validations on a string expected to be an email address:
 
 Is a valid email address, from a parser perspective, following RFCs on email addresses.
 Is not using "Encoded-word" format.
 Is not using comment format.
 Is not using "Punycode" format.
 Is not using UUCP style addresses.
 Is not using address literals.
 Is not using source routes.
 Is not using the "percent hack".
 <br>
 This is based on the research work from <a href="https://portswigger.net/research/gareth-heyes">Gareth Heyes</a> added in references (Portswigger).<br><br>

 <b>Note:</b> The notion of valid, here, is to take from a secure usage of the data perspective.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isExcelCSVSafe(java.lang.String)" class="member-name-link">isExcelCSVSafe(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validations on a EXCEL CSV file provided (file was expected to be opened in Microsoft EXCEL):
 
 Real CSV file.
 Do not contains any payload related to a CSV injections.
 
 Ensure that, if Apache Commons CSV does not find any record then, the file will be considered as NOT safe (prevent potential bypasses).<br><br>
 <b>Note:</b> Record delimiter used is the <code>,</code> (comma) character.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isImageSafe(java.lang.String,java.util.List)" class="member-name-link">isImageSafe(String, List&lt;String&gt;)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validations on a image file provided:
 
 Real image file.
 Its mime type is into the list of allowed mime types.
 Its metadata fields do not contains any characters related to a malicious payloads.
 
 <br>
 <b>Important note:</b> This implementation is prone to bypass using the "<b>raw insertion</b>" method documented in the <a href="https://www.synacktiv.com/en/publications/persistent-php-payloads-in-pngs-how-to-inject-php-code-in-an-image-and-keep-it-there">blog post</a> from the Synacktiv team.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isJSONSafe(java.lang.String,int,int)" class="member-name-link">isJSONSafe(String, int, int)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validations on a JSON string provided:
 
 Real JSON structure.
 Contain less than a specified number of deepness for nested objects or arrays.
 Contain less than a specified number of items in any arrays.
 
 <br>
 <b>Note:</b> I decided to use a parsing approach using only string processing to prevent any StackOverFlow or OutOfMemory error that can be abused.<br><br>
 I used the following assumption:
 
      The character <code>{</code> identify the beginning of an object.
      The character <code>}</code> identify the end of an object.
      The character <code>[</code> identify the beginning of an array.
      The character <code>]</code> identify the end of an array.
      The character <code>"</code> identify the delimiter of a string.
      The character sequence <code>\"</code> identify the escaping of an double quote.
 </div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isPathSafe(java.lang.String)" class="member-name-link">isPathSafe(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validations on a string expected to be an system file/folder path:
 
 Does not contains path traversal payload.
 <br></div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isPDFSafe(java.lang.String)" class="member-name-link">isPDFSafe(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validations on a PDF file provided:
 
 Real PDF file.
 No attachments.
 No Javascript code.
 No links using action of type URI/Launch/RemoteGoTo/ImportData.
 </div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isPSD2StetSafeCertificateURL(java.lang.String)" class="member-name-link">isPSD2StetSafeCertificateURL(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">The <a href="https://www.stet.eu/en/psd2/">PSD2 STET</a> specification require to use <a href="https://datatracker.ietf.org/doc/draft-cavage-http-signatures/">HTTP Signature</a>.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isPublicIPAddress(java.lang.String)" class="member-name-link">isPublicIPAddress(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validations on a string expected to be an public IP address:
 
 Is a valid IP v4 or v6 address.
 Is public from an Internet perspective.
 
 <br>
 <b>Note:</b> I often see missing such validation in the value read from HTTP request headers like "X-Forwarded-For" or "Forwarded".</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isRelativeURL(java.lang.String)" class="member-name-link">isRelativeURL(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Validate that the URL provided is really a relative URL.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isWeakPINCode(java.lang.String)" class="member-name-link">isWeakPINCode(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validation to verify if a provided PIN code is considered weak (easy to guess) or none.<br>
 This method consider that format of the PIN code is [0-9]{6,}<br>
 Rule to consider a PIN code as weak:
 
 Length is inferior to 6 positions.
 Contain only the same number or only a sequence of zero.
 Contain sequence of following incremental or decremental numbers.
 </div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isWord972003DocumentSafe(java.lang.String)" class="member-name-link">isWord972003DocumentSafe(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validations on a Word 97-2003 (binary format) document file provided:
 
 Real Microsoft Word 97-2003 document file.
 No VBA Macro.<br>
 No embedded objects.
 </div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isXMLOnlyUseAllowedXSDorDTD(java.lang.String,java.util.List)" class="member-name-link">isXMLOnlyUseAllowedXSDorDTD(String, List&lt;String&gt;)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Ensure that an XML file only uses DTD/XSD references (called System Identifier) present in the allowed list provided.<br><br>
 The code is based on the validation implemented into the OpenJDK 21, by the class <b><a href="https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.prefs/share/classes/java/util/prefs/XmlSupport.java">java.util.prefs.XmlSupport</a></b>, in the method <b><a href="https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.prefs/share/classes/java/util/prefs/XmlSupport.java#L240">loadPrefsDoc()</a></b>.<br><br>
 The method also ensure that no Public Identifier is used to prevent potential bypasses of the validations.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isXMLSafe(java.lang.String)" class="member-name-link">isXMLSafe(String)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Ensure that an XML file does not contain any External Entity, DTD or XInclude instructions.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html#isZIPSafe(java.lang.String,int,boolean)" class="member-name-link">isZIPSafe(String, int, boolean)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Apply a collection of validations on a ZIP file provided:
 
 Real ZIP file.
 Contain less than a specified level of deepness.
 Do not contain Zip-Slip entry path.
 </div>
</dd>
</dl>
<h2 class="title" id="I:P">P</h2>
<dl class="index">
<dt><a href="eu/righettod/InputFileType.html#PDF" class="member-name-link">PDF</a> - Enum constant in enum class eu.righettod.<a href="eu/righettod/InputFileType.html" title="enum class in eu.righettod">InputFileType</a></dt>
<dd>
<div class="block">PDF file</div>
</dd>
<dt><a href="eu/righettod/ProcessingMode.html" class="type-name-link" title="enum class in eu.righettod">ProcessingMode</a> - Enum Class in <a href="eu/righettod/package-summary.html">eu.righettod</a></dt>
<dd>
<div class="block">Enumeration used by the method <code>SecurityUtils.ensureSerializedObjectIntegrity()</code> to define its working mode.</div>
</dd>
<dt><a href="eu/righettod/ProcessingMode.html#PROTECT" class="member-name-link">PROTECT</a> - Enum constant in enum class eu.righettod.<a href="eu/righettod/ProcessingMode.html" title="enum class in eu.righettod">ProcessingMode</a></dt>
<dd>
<div class="block">Protection mode: Add the integrity HMAC to the linked serialized object.</div>
</dd>
</dl>
<h2 class="title" id="I:S">S</h2>
<dl class="index">
<dt><a href="eu/righettod/SecurityUtils.html#sanitizeFile(java.lang.String,eu.righettod.InputFileType)" class="member-name-link">sanitizeFile(String, InputFileType)</a> - Static method in class eu.righettod.<a href="eu/righettod/SecurityUtils.html" title="class in eu.righettod">SecurityUtils</a></dt>
<dd>
<div class="block">Rewrite the input file to remove any embedded files that is not embedded using a methods supported by the official format of the file.<br>
 Example: a file can be embedded by adding it to the end of the source file, see the reference provided for details.</div>
</dd>
<dt><a href="eu/righettod/SecurityUtils.html" class="type-name-link" title="class in eu.righettod">SecurityUtils</a> - Class in <a href="eu/righettod/package-summary.html">eu.righettod</a></dt>
<dd>
<div class="block">Provides different utilities methods to apply processing from a security perspective.<br>
 These code snippet:
 
     Can be used, as "foundation", to customize the validation to the app context.
     Were implemented in a way to facilitate adding or removal of validations depending on usage context.
     Were centralized on one class to be able to enhance them across time as well as <a href="https://github.com/righettod/code-snippets-security-utils/issues">missing case/bug identification</a>.
 </div>
</dd>
</dl>
<h2 class="title" id="I:V">V</h2>
<dl class="index">
<dt><a href="eu/righettod/ProcessingMode.html#VALIDATE" class="member-name-link">VALIDATE</a> - Enum constant in enum class eu.righettod.<a href="eu/righettod/ProcessingMode.html" title="enum class in eu.righettod">ProcessingMode</a></dt>
<dd>
<div class="block">Validation of the protection mode: Verify the integrity HMAC against the linked serialized object.</div>
</dd>
<dt><a href="eu/righettod/InputFileType.html#valueOf(java.lang.String)" class="member-name-link">valueOf(String)</a> - Static method in enum class eu.righettod.<a href="eu/righettod/InputFileType.html" title="enum class in eu.righettod">InputFileType</a></dt>
<dd>
<div class="block">Returns the enum constant of this class with the specified name.</div>
</dd>
<dt><a href="eu/righettod/ProcessingMode.html#valueOf(java.lang.String)" class="member-name-link">valueOf(String)</a> - Static method in enum class eu.righettod.<a href="eu/righettod/ProcessingMode.html" title="enum class in eu.righettod">ProcessingMode</a></dt>
<dd>
<div class="block">Returns the enum constant of this class with the specified name.</div>
</dd>
<dt><a href="eu/righettod/InputFileType.html#values()" class="member-name-link">values()</a> - Static method in enum class eu.righettod.<a href="eu/righettod/InputFileType.html" title="enum class in eu.righettod">InputFileType</a></dt>
<dd>
<div class="block">Returns an array containing the constants of this enum class, in
the order they are declared.</div>
</dd>
<dt><a href="eu/righettod/ProcessingMode.html#values()" class="member-name-link">values()</a> - Static method in enum class eu.righettod.<a href="eu/righettod/ProcessingMode.html" title="enum class in eu.righettod">ProcessingMode</a></dt>
<dd>
<div class="block">Returns an array containing the constants of this enum class, in
the order they are declared.</div>
</dd>
</dl>
<a href="#I:A">A</a>&nbsp;<a href="#I:C">C</a>&nbsp;<a href="#I:E">E</a>&nbsp;<a href="#I:I">I</a>&nbsp;<a href="#I:P">P</a>&nbsp;<a href="#I:S">S</a>&nbsp;<a href="#I:V">V</a>&nbsp;<br><a href="allclasses-index.html">All&nbsp;Classes&nbsp;and&nbsp;Interfaces</a><span class="vertical-separator">|</span><a href="allpackages-index.html">All&nbsp;Packages</a></main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>code-snippets-security-utils - 1.0.0-SNAPSHOT</small></p>
</footer>
</div>
</div>
</body>
</html>
